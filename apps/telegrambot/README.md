# Telegram Bot Integration

ะขะตะปะตะณัะฐะผ-ะฑะพั ัะตะฐะปะธะทะพะฒะฐะฝ ะฒ ะฟัะธะปะพะถะตะฝะธะธ `apps.telegrambot` ะธ ะฟะพะบััะฒะฐะตั ััะตะฝะฐัะธะธ ะดะปั ะฒัะตั ัะพะปะตะน: ะะพััั, ะะธะตะปัะพั, ะกัะฟะตั ะะดะผะธะฝ ะธ ะกัะฟะตัะฟะพะปัะทะพะฒะฐัะตะปั.

ะะพั ะธัะฟะพะปัะทัะตั ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด ะบะปะฐะฒะธะฐััั: ะพัะฝะพะฒะฝะพะต ะฝะฐะฒะธะณะฐัะธะพะฝะฝะพะต ะผะตะฝั โ ReplyKeyboard, ะดะตะนััะฒะธั ะฒ ัะฟะธัะบะฐั โ InlineKeyboard.

ะะปััะตะฒัะต ะบะพะผะฐะฝะดั:

- `/start` ะธะปะธ `/menu` โ ะณะปะฐะฒะฝะพะต ะผะตะฝั ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะพะปะธ.
- `/register` โ ัะตะณะธัััะฐัะธั ะฝะพะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั (ัะตะปะตัะพะฝ + email), ะฟัะธะฒัะทะบะฐ Telegram.
- `/link` โ ะฟัะธะฒัะทะบะฐ ัััะตััะฒัััะตะณะพ ะฐะบะบะฐัะฝัะฐ ะบ Telegram ัะตัะตะท 6-ะทะฝะฐัะฝัะน ะบะพะด (ะฝะฐ email).
- `/help` โ ัะฟัะฐะฒะบะฐ ะฟะพ ะดะพัััะฟะฝัะผ ะบะพะผะฐะฝะดะฐะผ.

ะะพััั (Guest):
- ยซ๐ ะะพะธัะบยป โ ะฟะพัะฐะณะพะฒัะต ัะธะปัััั (ะณะพัะพะด, ะดะฐัั, ัะตะฝะฐ, ัะดะพะฑััะฒะฐ). ะะตะทัะปััะฐัั ั ะบะฝะพะฟะบะฐะผะธ: ยซะะพะดัะพะฑะฝะตะตยป, ยซะะฐะฑัะพะฝะธัะพะฒะฐััยป, ยซะ ะธะทะฑัะฐะฝะฝะพะตยป.
- ยซ๐ฆ ะะพะธ ะฑัะพะฝะธัะพะฒะฐะฝะธัยป โ ัะฟะธัะพะบ ั ะดะตะนััะฒะธัะผะธ: ยซะัะผะตะฝะธััยป, ยซะััะฐะฒะธัั ะพัะทัะฒยป.
- ยซโญ ะะทะฑัะฐะฝะฝะพะตยป โ ัะฟะธัะพะบ, ัะดะฐะปะธัั ะธะท ะธะทะฑัะฐะฝะฝะพะณะพ.
- ยซ๐ ะัะทัะฒัยป โ ะพััะฐะฒะธัั ะพัะทัะฒ ะฟะพ ะทะฐะฒะตััะตะฝะฝะพะผั ะฑัะพะฝะธัะพะฒะฐะฝะธั.
- ยซ๐ ะฃะฒะตะดะพะผะปะตะฝะธัยป โ ะฟัะพัะผะพัั ะฝะตะฟัะพัะธัะฐะฝะฝัั, ะพัะผะตัะบะฐ ะฟัะพัะธัะฐะฝะฝัั.

ะะธะตะปัะพั (Realtor):
- ยซ๐ ะะพะธ ะพะฑัะตะบััยป โ ัะฟะธัะพะบ, ะบะฐััะพัะบะฐ, ยซะะบัะธะฒะธัะพะฒะฐัั/ะกะฝัััยป, ยซะะฐะปะตะฝะดะฐััยป, ยซะะพะฑะฐะฒะธัั ะฑะปะพะบยป.
- ยซโ ะะพะฑะฐะฒะธัั ะพะฑัะตะบัยป โ ะผะฐััะตั ั ะพะฑัะทะฐัะตะปัะฝัะผะธ ะฟะพะปัะผะธ (ะฝะฐะทะฒะฐะฝะธะต, ะณะพัะพะด, ัะตะฝะฐ, ะณะพััะธ, ะพะฟะธัะฐะฝะธะต).
- ยซ๐ ะัะพะฝะธยป โ ัะฟะธัะพะบ ะฑัะพะฝะตะน ะฟะพ ัะฒะพะธะผ ะพะฑัะตะบัะฐะผ, ยซะะพะดัะฒะตัะดะธััยป, ยซะัะผะตะฝะธััยป.
- ยซ๐ ะฃะฒะตะดะพะผะปะตะฝะธัยป โ ัะฟะธัะพะบ ะฝะตะฟัะพัะธัะฐะฝะฝัั.

ะกัะฟะตั ะะดะผะธะฝ (Super Admin):
- ยซ๐ฅ ะะธะตะปัะพััยป โ ัะฟะธัะพะบ, ยซะะบัะธะฒะธัะพะฒะฐัั/ะะตะฐะบัะธะฒะธัะพะฒะฐััยป, ยซโ ะะพะฑะฐะฒะธััยป (email/ัะตะปะตัะพะฝ/ะธะผั/ะฟะฐัะพะปั).
- ยซ๐ ะะณะตะฝัััะฒะพยป โ ะบะปััะตะฒัะต ะผะตััะธะบะธ ะธ ะขะะ-ะพะฑัะตะบัั/ัะธะตะปัะพัั.

ะกัะฟะตัะฟะพะปัะทะพะฒะฐัะตะปั (Superuser):
- ยซ๐ข ะะณะตะฝัััะฒะฐยป โ ัะฟะธัะพะบ ะฐะณะตะฝัััะฒ (ะพะฑะทะพัะฝัะต ะดะฐะฝะฝัะต) ั ะฒะพะทะผะพะถะฝะพัััั ะฐะบัะธะฒะธัะพะฒะฐัั/ะดะตะฐะบัะธะฒะธัะพะฒะฐัั.
- ยซ๐ ะะพะปัะทะพะฒะฐัะตะปัยป โ ะฟะพะธัะบ ะฟะพะปัะทะพะฒะฐัะตะปั (email/ัะตะปะตัะพะฝ), ัะผะตะฝะฐ ััะฐัััะฐ (ะฐะบัะธะฒะตะฝ/ะทะฐะฑะปะพะบะธัะพะฒะฐะฝ).
- ยซ๐ฅ ะะพะปัะทะพะฒะฐัะตะปะธยป โ ัะฟะธัะพะบ ะฟะพัะปะตะดะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ั ะบะฝะพะฟะบะฐะผะธ ัะผะตะฝั ัะพะปะธ (ะะพััั/ะะธะตะปัะพั/ะกัะฟะตั ะะดะผะธะฝ/ะกัะฟะตัะฟะพะปัะทะพะฒะฐัะตะปั) ะธ ะฟะตัะตะบะปััะฐัะตะปะตะผ ััะฐัััะฐ.
  - ะ ะบะฐััะพัะบะต ะฐะณะตะฝัััะฒะฐ ะดะพัััะฟะฝะฐ ะบะฝะพะฟะบะฐ ยซะะพะดัะพะฑะฝะตะตยป ั ะฟะพะบะฐะทะพะผ ะผะตััะธะบ: ัะธะตะปัะพัะพะฒ, ะพะฑัะตะบัะพะฒ, ะฑัะพะฝะธัะพะฒะฐะฝะธะน, ะดะพัะพะดะฐ, ะบะพะฝัะฐะบัะพะฒ.

ะะธะตะปัะพัั (ะกัะฟะตัะฟะพะปัะทะพะฒะฐัะตะปั):
- ยซ๐จโ๐ผ ะะธะตะปัะพััยป โ ัะฟะธัะพะบ ัะธะตะปัะพัะพะฒ ะฟะพ ะฒัะตะน ะฟะปะฐััะพัะผะต ั ะดะตะนััะฒะธัะผะธ:
  - ยซะกะผะตะฝะธัั ะฐะณะตะฝัััะฒะพยป โ ะฒะฒะพะด ID ะธะปะธ ัะฐััะธ ะฝะฐะทะฒะฐะฝะธั/ะณะพัะพะดะฐ, ะฒัะฑะพั ะธะท ะฝะฐะนะดะตะฝะฝัั ะธ ะฝะฐะทะฝะฐัะตะฝะธะต.
  - ยซะฃะฑัะฐัั ะฐะณะตะฝัััะฒะพยป โ ะพัะฒัะทะฐัั ะพั ะฐะณะตะฝัััะฒะฐ.
  - ยซะะบัะธะฒะธัะพะฒะฐัั/ะะตะฐะบัะธะฒะธัะพะฒะฐััยป โ ัะผะตะฝะฐ ััะฐัััะฐ ััััะฝะพะน ะทะฐะฟะธัะธ.

ะะฟะปะฐัะฐ (ะดะตะผะพ):
- ะะพัะปะต ัะพะทะดะฐะฝะธั ะฑัะพะฝะธ ะดะพัััะฟะฝะฐ ะบะฝะพะฟะบะฐ ยซะะฟะปะฐัะธัั (ะดะตะผะพ)ยป. ะะฟะปะฐัะฐ ัะพะทะดะฐัั Payment ะธ ะฟะตัะตะฒะพะดะธั ะฑัะพะฝั ะฒ ััะฐััั Confirmed.

## ะะฐะฟััะบ ะฑะพัะฐ

```bash
export TELEGRAM_BOT_TOKEN="<token>"
python manage.py telegram_bot
```

ะะพั ะธัะฟะพะปัะทัะตั `python-telegram-bot` (async API). ะะตัะตัะตะฝั ะบะพะผะฐะฝะด ะดะพัััะฟะตะฝ ัะตัะตะท `/help`.

## ะะพะดะตะปะธ

- `TelegramProfile` โ ััะฐะฝะธั ัะฒัะทะบั telegram_id โ ะฟะพะปัะทะพะฒะฐัะตะปั, ัะตะปะตัะพะฝ ะธ ัะทัะบ.
- `TelegramVerificationCode` โ ะพะดะฝะพัะฐะทะพะฒัะต ะบะพะดั ะดะปั ะฟัะธะฒัะทะบะธ ะฐะบะบะฐัะฝัะฐ (TTL = 10 ะผะธะฝัั, 3 ะฟะพะฟััะบะธ).

## ะกะตัะฒะธัั

ะกะตัะฒะธัะฝัะต ััะฝะบัะธะธ ะฝะฐัะพะดัััั ะฒ `apps.telegrambot.services`:

- `register_new_user` โ ัะพะทะดะฐัั ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะพัะฟัะฐะฒะปัะตั ะฟัะธะฒะตัััะฒะตะฝะฝะพะต ะฟะธััะผะพ.
- `initiate_link_existing_account` โ ะณะตะฝะตัะธััะตั ะธ ะพัะฟัะฐะฒะปัะตั ะบะพะด ะฟะพะดัะฒะตัะถะดะตะฝะธั ะฝะฐ email.
- `confirm_link_code` โ ะฟัะพะฒะตััะตั ะบะพะด ะธ ะฟัะธะฒัะทัะฒะฐะตั ะฟัะพัะธะปั.
  
ะะพั ัะฐะบะถะต ะธัะฟะพะปัะทัะตั ะผะพะดะตะปะธ ะดะพะผะตะฝะพะฒ ะฝะฐะฟััะผัั (ORM) ะดะปั ะพะฟะตัะฐัะธะน ะฑัะพะฝะธัะพะฒะฐะฝะธะน, ะธะทะฑัะฐะฝะฝะพะณะพ, ะพัะทัะฒะพะฒ, ะพะฑัะตะบัะพะฒ ะธ ะบะฐะปะตะฝะดะฐัั.

## ะะฐะปัะฝะตะนัะตะต ัะฐััะธัะตะฝะธะต

- ะะฝัะตะณัะฐัะธั ะฟะปะฐัะตะถะฝะพะณะพ ะฟัะพะฒะฐะนะดะตัะฐ (Kaspi) ะดะปั ะณะตะฝะตัะฐัะธะธ ะฟะปะฐัะตะถะฝัั ัััะปะพะบ ะฒะฝัััะธ ะฑะพัะฐ.
- ะะพะดะตัะฐัะธั ะบะพะฝัะตะฝัะฐ, ะณะปะพะฑะฐะปัะฝัะต ะพััะตัั ะธ ัะบัะฟะพัั.
- ะะพะปะฝะพัะตะฝะฝัะน ัะฐั ะผะตะถะดั ะณะพััะตะผ ะธ ัะธะตะปัะพัะพะผ (ะพัะดะตะปัะฝัะน ะผะพะดัะปั).
