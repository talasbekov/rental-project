@startuml C4_Context
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()

title System Context diagram for ЖильеGO Platform

' === РОЛИ ПОЛЬЗОВАТЕЛЕЙ (согласно Use Cases) ===
Person(guest, "Гость", "Неавторизованный пользователь: просматривает объекты и ищет жилье")
Person(user, "Пользователь", "Авторизованный клиент: бронирует жилье, оплачивает, оставляет отзывы, управляет избранным")
Person(realtor, "Риелтор", "Владелец объектов: управляет своими объявлениями, просматривает бронирования своих объектов, получает аналитику")
Person(super_admin, "Супер Админ", "Руководитель агентства: управляет риелторами своей команды, просматривает агрегированную аналитику")
Person(superuser, "Суперпользователь", "Владелец платформы: глобальная аналитика, модерация, настройки системы")

' Примечание: Роль "Модератор" удалена, так как не описана в Use Cases

System(zhilyego, "ЖильеGO Platform", "B2B2C платформа посуточной аренды жилья с гарантией целостности бронирований")

System_Ext(kaspi, "Kaspi Pay", "Платежный шлюз для онлайн-оплаты и возвратов")
System_Ext(telegram, "Telegram Bot API", "Мессенджер для уведомлений и bot-интерфейса")
System_Ext(email, "Email Service", "SMTP сервер для отправки писем, чеков и подтверждений")

' === ВЗАИМОДЕЙСТВИЯ ===
Rel(guest, zhilyego, "Просмотр объектов, поиск жилья (без регистрации)", "HTTPS")
Rel(user, zhilyego, "Бронирование, оплата, избранное, отзывы", "HTTPS/Telegram")
Rel(realtor, zhilyego, "Управление своими объектами, просмотр броней, аналитика", "HTTPS/Telegram")
Rel(super_admin, zhilyego, "Управление командой риелторов, аналитика по команде", "HTTPS")
Rel(superuser, zhilyego, "Глобальная аналитика, модерация, настройки", "HTTPS")

Rel(zhilyego, kaspi, "Создание платежей, обработка транзакций", "HTTPS/JSON")
Rel(kaspi, zhilyego, "Webhook уведомления о статусе платежа", "HTTPS/JSON")

Rel(zhilyego, telegram, "Отправка уведомлений, bot команды", "HTTPS/Bot API")
Rel(zhilyego, email, "Отправка писем, чеков, инструкций", "SMTP")

note right of super_admin
  Супер Админ (Руководитель агентства):
  - Видит объекты и бронирования своих риелторов
  - Агрегированная аналитика по команде
  - Управление риелторами (добавление, деактивация)
  - Доступ к кодам объектов (с логированием)
end note

note right of superuser
  Суперпользователь (Владелец платформы):
  - Полный доступ ко всей системе
  - Глобальная аналитика
  - Модерация контента (опционально)
  - Настройки платформы
end note

@enduml
